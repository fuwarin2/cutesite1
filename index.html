<script>
  const form = document.getElementById('estimate-form');
  const radios = form.querySelectorAll('input[type="radio"]');
  const totalDisplay = document.getElementById('total');

  function calculateTotal() {
    let base = 0;
    let size = 0;
    let usePercentage = 0;

    radios.forEach(radio => {
      if (radio.checked) {
        const name = radio.name;
        const value = parseInt(radio.value, 10);
        if (name === 'style') base = value;
        else if (name === 'size') size = value;
        else if (name === 'use') usePercentage = value;
      }
    });

    const subtotal = base + size;
    const final = usePercentage === 50 ? Math.floor(subtotal * 1.5) : subtotal;
    totalDisplay.textContent = `合計金額: ${final.toLocaleString()}円`;
    return final;
  }

  radios.forEach(radio => {
    radio.addEventListener('change', calculateTotal);
  });

  form.addEventListener('submit', function(e) {
    e.preventDefault();

    const total = calculateTotal();

    // 各ラジオボタンの値を取得
    const use = form.querySelector('input[name="use"]:checked').nextSibling.textContent.trim();
    const size = form.querySelector('input[name="size"]:checked').nextSibling.textContent.trim();
    const style = form.querySelector('input[name="style"]:checked').nextSibling.textContent.trim();

    const body = 
      `見積もり金額: ${total.toLocaleString()}円\n\n` +
      `ご利用用途: ${use}\n` +
      `納品サイズ: ${size}\n` +
      `キャラクター形式: ${style}\n\n` +
      `その他のご希望や詳細をこちらにご記入ください:\n`;

    const subject = 'イラスト見積もりの問い合わせ';
    const mailtoLink = `mailto:cryptoaccont01@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

    window.open(mailtoLink);
  });

  calculateTotal();
</script>
